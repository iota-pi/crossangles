function fetchData(e){"use strict";var o,t=[],s={},a={};for(o=0;o<courseList.length;o+=1)"CBS"!==courseList[o]&&timetableData.hasOwnProperty(courseList[o])&&(a[courseList[o]]=timetableData[courseList[o]].slice(1));for(function(){var e,t,o,n,i,r,c;for(e in a)if(a.hasOwnProperty(e)&&(s[e]={},t=a[e],null!==t))for(r=0;r<t.length;r+=1){for(o=t[r],n=[],i=[],c=4;c<o.length;c+=2)-1===n.indexOf(o[c])&&(n.push(times_index[o[c]]),i.push(locations_index[o[c+1]]));if(n=n.join(","),0!==n.length){s[e].hasOwnProperty(o[0])||(s[e][o[0]]=[]);var l=["O","F","C","S","T","c"][o[1]],u=components_index[o[0]];s[e][o[0]].push({time:n,status:l,enrols:o[2]+","+o[3],course:e,component:u,location:i})}}}(),s.CBS={},$("#tbt").is(":checked")&&(s.CBS.TBT=JSON.parse(JSON.stringify(CBS.TBT))),$("#cth").is(":checked")&&(s.CBS.CoreTheo=JSON.parse(JSON.stringify(CBS.CoreTheo))),$("#ctr").is(":checked")&&(s.CBS.CoreTrain=JSON.parse(JSON.stringify(CBS.CoreTrain))),$("#bib").is(":checked")&&(s.CBS.BibleStudy=JSON.parse(JSON.stringify(CBS.BibleStudy))),o=0;o<customClasses.length;o+=1){var n={};for(var i in customClasses[o])customClasses[o].hasOwnProperty(i)&&(n[i]=customClasses[o][i]);s[n.course]={},s[n.course][n.component]=[n]}!function(){var e,a;for(e in s)if(s.hasOwnProperty(e))for(a in s[e])s[e].hasOwnProperty(a)&&t.push([s[e][a],s[e][a].length]);t.sort(function(e,t){return e[1]-t[1]}),t=t.map(function(e){return e[0]}),t=t.map(function(e){return e.map(function(e){var t=e.time.split(","),s=t.map(function(e){var t=-1!==e.indexOf("#"),s=e.replace(/[^\d\-.]/g,"").split("-");return 1===s.length&&(s[1]=+s[0]+1),[e[0],+s[0],+s[1],t]});return e.time=s,e})})}(),function(){t=t.map(function(e){return e.filter(function(e){var a,t=e.time,s="MTWHF";for(a=0;a<t.length;a+=1)if(-1===s.indexOf(t[a][0]))return!1;return!0})})}(),function(){var e,s,a,o,n,i,r,c,l;for(s=0;s<t.length;s+=1){for(o=t[s],e={},a=0;a<o.length;a+=1)n=o[a],i=n.time.join(","),e.hasOwnProperty(i)?(r=e[i],"O"===n.status&&"O"!==r.status?e[i]=n:"F"===n.status&&"O"!==r.status&&"F"!==r.status?e[i]=n:(c=n.enrols.split(","),l=r.enrols.split(","),c[1]-c[0]<l[1]-l[0]&&(e[i]=n))):e[i]=n;t[s]=[];for(i in e)e.hasOwnProperty(i)&&t[s].push(e[i])}}(),function(){var e,s,a;for(e=0;e<t.length;e+=1)for(a=t[e],s=a.length-1;s>=0;s-=1)$("#fullclasses").is(":checked")?"O"!==a[s].status&&"F"!==a[s].status&&a.splice(s,1):"O"!==a[s].status&&a.splice(s,1)}(),t.sort(function(e,t){return e.length-t.length}),e(t)}function generate(e,t){"use strict";function o(o){var i,r,c,l,u,d,f,m,n=search(o,a,s);if(e){if(null===n)return pageError("Sorry about that!","We weren't able to create a timetable for you. Maybe try again with different courses, or including full classes."),void $("#timetable").removeClass("loading");for(f=1/0,m=-(1/0),i=0;i<classList.length;i+=1)classList[i].remove();for($(".class-shadow").remove(),clearLists(t),showEmpty(),l=[],i=0;i<n.length;i+=1)c=n[i],u=courseList.indexOf(c.course),createClass(c,u,l);for(i=0;i<o.length;i+=1)for(r=0;r<o[i].length;r+=1)u=courseList.indexOf(o[i][r].course),d=createShadow(o[i][r],u),f=Math.min(f,d.min),m=Math.max(m,d.max);t?restoreClasses():saveState(!0),hideEmpty(Math.floor(f),Math.floor(m)),$("#timetable").removeClass("loading")}}e!==!1&&(e=!0),t!==!0&&(t=!1),e===!0&&$("#timetable").addClass("loading"),clearWarning();var s=t?0:void 0,a=100*+document.getElementById("canclash").checked;fetchData(o)}
