function fetchData(e){"use strict";var t="courses="+encodeURI(JSON.stringify(courseList)),r=[];$.getJSON("data.php",t,function(t){function i(e,t){function u(e,t){var n=e[0].replace(/[^\d\-,.]/g,"").split(/[,\-]/).map(function(e){return Math.ceil(+e)}),i=t[0].replace(/[^\d\-,.]/g,"").split(/[,\-]/).map(function(e){return Math.ceil(+e)}),a=function(e){return r.indexOf(e)},o=Math.max.apply(null,n.map(a)),s=Math.max.apply(null,i.map(a));return o-s}function c(e,t){var r=e[0].replace(/[\d\- ]/g,"").split(","),i=t[0].replace(/[\d\- ]/g,"").split(","),a=function(e){return n.indexOf(e)},o=Math.max.apply(null,r.map(a)),s=Math.max.apply(null,i.map(a));return o-s}function f(e,t){return e[1]===t[1]?0:"O"===e[1]?-1:1}var s,l,r=[12,13,14,11,15,16,10,17,18,19,20,9,21,22,23,8,7,6,5,4,3,2,1,0],n=["M","T","H","F","W","S","s"];for(s=0,l=[f,u,c];0===s&&(s=l.shift()(e,t),0!==l.length););return s}var n={};!function(){var e,r,i,a,o,s,l;for(e in t)if(t.hasOwnProperty(e)&&(n[e]={},r=t[e],null!==r))for(s=0;s<r.length;s+=1){for(i=r[s],a=i[3],o=[],l=0;l<a.length;l+=1)o.push(a[l][0]);o=o.join(","),n[e].hasOwnProperty(i[0])||(n[e][i[0]]=[]),0!==o.length&&n[e][i[0]].push([o,i[1],i[2],e,i[0]])}}(),n.CBS={},$("#tbt").is(":checked")&&(n.CBS.TBT=[["T 12","O","0,1","CBS","The Bible Talks"],["T 13","O","0,1","CBS","The Bible Talks"],["H 12","O","0,1","CBS","The Bible Talks"],["H 13","O","0,1","CBS","The Bible Talks"]]),$("#cth").is(":checked")&&(n.CBS.CoreTheo=[["T 17","O","0,1","CBS","Core Theology"],["W 13","O","0,1","CBS","Core Theology"]]),$("#ctr").is(":checked")&&(n.CBS.CoreTrain=[["T 16","O","0,1","CBS","Core Training"],["T 18","O","0,1","CBS","Core Training"],["W 12","O","0,1","CBS","Core Training"],["W 14","O","0,1","CBS","Core Training"]]),$("#bib").is(":checked")&&(n.CBS.BibleStudy=[["M 11","O","0,1","CBS","Bible Study"],["M 12","O","0,1","CBS","Bible Study"],["M 13","O","0,1","CBS","Bible Study"],["M 14","O","0,1","CBS","Bible Study"],["T 11","O","0,1","CBS","Bible Study"],["T 14","O","0,1","CBS","Bible Study"],["W 11","O","0,1","CBS","Bible Study"],["H 11","O","0,1","CBS","Bible Study"],["H 14","O","0,1","CBS","Bible Study"]]),function(){var e,t;for(e in n)if(n.hasOwnProperty(e))for(t in n[e])n[e].hasOwnProperty(t)&&r.push([n[e][t].sort(i),n[e][t].length]);r.sort(function(e,t){return e[1]-t[1]}),r=r.map(function(e){return e[0]})}(),e(r)})}function generate(){"use strict";fetchData(function(e){function t(e,t){return e[0]!==t[0]?!1:(e=e.replace(/[^\d\-.]/g,"").split("-"),t=t.replace(/[^\d\-.]/g,"").split("-"),1===e.length&&(e[1]=e[0]),1===t.length&&(t[1]=t[0]),e[0]>=t[1]&&e[0]>t[0]||t[0]>=e[1]&&t[0]>e[0]?!1:!0)}function r(r,n){var i,a,o,s,l,u=n.split(",");for(i=0;i<u.length;i+=1)for(a=0;a<r.length;a+=1)for(s=e[a][r[a]],l=s[0].split(","),o=0;o<l.length;o+=1)if(t(u[i],l[o]))return!0;return!1}function i(){for(var i,a,t=[],n=0;n<e.length;){for(i=e[n],a=t[n]||0;r(t,i[a][0])&&(a+=1,a!==i.length););if(a===i.length){if(t[n]=0,t.pop(),n-=1,0>n)return console.error("Could not generate timetable! Some clashes could not be resolved."),null}else t[n]=a,n+=1}return t=t.map(function(t,r){return e[r][t]})}console.log(e);var o,s,l,u,c,a=i();for(o=0;o<classList.length;o+=1)classList[o].remove();for($(".class-shadow").remove(),clearLists(),u=[],o=0;o<a.length;o+=1)l=a[o],c=courseList.indexOf(l[3]),createClass(l[0],l[3],l[4],c,u);for(u=[],o=0;o<e.length;o+=1)for(s=0;s<e[o].length;s+=1)c=courseList.indexOf(e[o][s][3]),createShadow(e[o][s][0],e[o][s][3]+e[o][s][4],c,u)})}
