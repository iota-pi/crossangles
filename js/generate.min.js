function fetchData(t){"use strict";var e="courses="+encodeURI(JSON.stringify(courseList)),i=[];$.getJSON("data.php",e,function(e){var n={};!function(){var t,i,o,r,s,a,l;for(t in e)if(e.hasOwnProperty(t)&&(n[t]={},i=e[t],null!==i))for(a=0;a<i.length;a+=1){for(o=i[a],r=o[3],s=[],l=0;l<r.length;l+=1)s.push(r[l][0]);s=s.join(","),n[t].hasOwnProperty(o[0])||(n[t][o[0]]=[]),0!==s.length&&n[t][o[0]].push([s,o[1],o[2],t,o[0]])}}(),n.CBS={},$("#tbt").is(":checked")&&(n.CBS.TBT=[["T 12","O","0,1","CBS","The Bible Talks"],["T 13","O","0,1","CBS","The Bible Talks"],["H 12","O","0,1","CBS","The Bible Talks"],["H 13","O","0,1","CBS","The Bible Talks"]]),$("#cth").is(":checked")&&(n.CBS.CoreTheo=[["T 17","O","0,1","CBS","Core Theology"],["W 13","O","0,1","CBS","Core Theology"]]),$("#ctr").is(":checked")&&(n.CBS.CoreTrain=[["T 16","O","0,1","CBS","Core Training"],["T 18","O","0,1","CBS","Core Training"],["W 12","O","0,1","CBS","Core Training"],["W 14","O","0,1","CBS","Core Training"]]),$("#bib").is(":checked")&&(n.CBS.BibleStudy=[["M 11","O","0,1","CBS","Bible Study"],["M 12","O","0,1","CBS","Bible Study"],["M 13","O","0,1","CBS","Bible Study"],["M 14","O","0,1","CBS","Bible Study"],["T 11","O","0,1","CBS","Bible Study"],["T 14","O","0,1","CBS","Bible Study"],["W 11","O","0,1","CBS","Bible Study"],["H 11","O","0,1","CBS","Bible Study"],["H 14","O","0,1","CBS","Bible Study"]]),function(){var t,e;for(t in n)if(n.hasOwnProperty(t))for(e in n[t])n[t].hasOwnProperty(e)&&i.push([n[t][e],n[t][e].length]);i.sort(function(t,e){return t[1]-e[1]}),i=i.map(function(t){return t[0]}),i=i.map(function(t){return t.map(function(t){var e=t[0].split(","),i=e.map(function(t){var e=t.replace(/[^\d\-.]/g,"").split("-");return 1===e.length&&(e[1]=+e[0]+1),[t[0],+e[0],+e[1]]});return t[0]=i,t})})}(),t(i)})}function generate(){"use strict";function t(t){var e={M:120,T:100,W:180,H:100,F:150},i={M:!1,T:!1,W:!1,H:!1,F:!1},n=-20,o=-20,r=-40,s=100,a=75,l=100,h=0;return function(){var r,n=t.map(function(t){return t[0][0]}),o=n.join("");for(r in e)e.hasOwnProperty(r)&&-1===o.indexOf(r)&&(h+=e[r],i[r]=!0);return h}(),function(){var e,i;for(i=0;i<t.length;i+=1)e=t[i][0],e[1]<10&&(h+=n),e[2]>=17&&(h+=o),e[2]>=20&&(h+=r);return h}(),function(){var e,n,o,r,f;for(e=0;e<t.length;e+=1)"The Bible Talks"===t[e][4]&&(n=t[e][0][0]),"Core Theology"===t[e][4]&&(o=t[e][0][0]),"Core Training"===t[e][4]&&(r=t[e][0][0]),"Bible Study"===t[e][4]&&(f=t[e][0][0]);n&&(h+=(1+!i[n])*s),o&&(h+=(1+!i[o])*a),r&&(h+=(1+!i[r])*a),f&&(h+=(1+!i[f])*l)}(),h}function e(t){var e,i,n;for(e=t.length-1;e>0;e-=1)i=Math.floor(Math.random()*(e+1)),n=t[e],t[e]=t[i],t[i]=n;return t}fetchData(function(i){function n(t,e){return t[0]!==e[0]?!1:t[1]>=e[2]||e[1]>=t[2]?!1:!0}function o(t,e,i){var o,r,s,a,l;for(o=0;o<i.length;o+=1)for(r=0;r<e.length;r+=1)for(a=t[r][e[r]],l=a[0],s=0;s<l.length;s+=1)if(n(i[o],l[s]))return!0;return!1}function r(t){for(var n,r,e=[],i=0;i<t.length;){for(n=t[i],r=e[i]+1||0;r<n.length&&o(t,e,n[r][0]);)r+=1;if(r===n.length){if(e[i]=0,e.pop(),i-=1,0>i)return null}else e[i]=r,i+=1}return e.map(function(e,i){return t[i][e]})}function s(n){n=void 0!==n?n:1e3;var o,s,l,f,h,a={score:-(1/0),timetable:[]};for(o=0;n>o;o+=1){for(h=i.slice(),s=0;s<h.length;s+=1)e(h[s]);if(l=r(h),null===l){0===o&&console.error("Could not generate timetable! Some clashes could not be resolved.");break}f=t(l),f>a.score&&(a.score=f,a.timetable=l)}return console.log("Generated timetable with score",a.score),a.timetable}console.log(i);var l,f,h,c,u,a=s();for(l=0;l<classList.length;l+=1)classList[l].remove();for($(".class-shadow").remove(),clearLists(),c=[],l=0;l<a.length;l+=1)h=a[l],u=courseList.indexOf(h[3]),createClass(h[0],h[3],h[4],u,c);for(c={},l=0;l<i.length;l+=1)for(f=0;f<i[l].length;f+=1)u=courseList.indexOf(i[l][f][3]),createShadow(i[l][f][0],i[l][f][3]+i[l][f][4],u,c)})}
