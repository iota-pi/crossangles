function fetchData(e){"use strict";var n,t=[],o={},s={};for(n=0;n<courseList.length;n+=1)"CBS"!==courseList[n]&&timetableData.hasOwnProperty(courseList[n])&&(s[courseList[n]]=timetableData[courseList[n]].slice(1));for(function(){function u(e){return e.filter(function(t,o){return e.map(String).indexOf(String(t))===o})}var e,t,n,a,i,r,c,l;for(e in s)if(s.hasOwnProperty(e)&&(o[e]={},t=s[e],null!==t))for(c=0;c<t.length;c+=1){for(n=t[c],a=n[3],a=u(a),i=[],r=[],l=0;l<a.length;l+=1)i.push(a[l][0]),r.push(a[l][1]);i=i.join(","),0!==i.length&&(o[e].hasOwnProperty(n[0])||(o[e][n[0]]=[]),o[e][n[0]].push({time:i,status:n[1],enrols:n[2],course:e,component:n[0],location:r}))}}(),o.CBS={},$("#tbt").is(":checked")&&(o.CBS.TBT=[{time:"T 12",status:"O",enrols:"0,1",course:"CBS",component:"The Bible Talks",location:["Elec Eng 418"]},{time:"T 13",status:"O",enrols:"0,1",course:"CBS",component:"The Bible Talks",location:["Elec Eng 418"]},{time:"H 12",status:"O",enrols:"0,1",course:"CBS",component:"The Bible Talks",location:["Rup Myers Theatre"]},{time:"H 13",status:"O",enrols:"0,1",course:"CBS",component:"The Bible Talks",location:["Rup Myers Theatre"]}]),$("#cth").is(":checked")&&(o.CBS.CoreTheo=[{time:"T 17",status:"O",enrols:"0,1",course:"CBS",component:"Core Theology",location:["Colombo C"]},{time:"W 13",status:"O",enrols:"0,1",course:"CBS",component:"Core Theology",location:["CLB 4"]}]),$("#ctr").is(":checked")&&(o.CBS.CoreTrain=[{time:"T 16",status:"O",enrols:"0,1",course:"CBS",component:"Core Training",location:["Quad Sundial"]},{time:"T 18",status:"O",enrols:"0,1",course:"CBS",component:"Core Training",location:["Quad Sundial"]},{time:"W 12",status:"O",enrols:"0,1",course:"CBS",component:"Core Training",location:["Quad Sundial"]},{time:"W 14",status:"O",enrols:"0,1",course:"CBS",component:"Core Training",location:["Quad Sundial"]}]),$("#bib").is(":checked")&&(o.CBS.BibleStudy=[{time:"M 11",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"M 12",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"M 13",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"M 14",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"T 11",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"T 14",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"W 11",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"H 11",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"H 14",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]}]),n=0;n<customClasses.length;n+=1){var a={};for(var i in customClasses[n])customClasses[n].hasOwnProperty(i)&&(a[i]=customClasses[n][i]);o[a.course]={},o[a.course][a.component]=[a]}!function(){var e,s;for(e in o)if(o.hasOwnProperty(e))for(s in o[e])o[e].hasOwnProperty(s)&&t.push([o[e][s],o[e][s].length]);t.sort(function(e,t){return e[1]-t[1]}),t=t.map(function(e){return e[0]}),t=t.map(function(e){return e.map(function(e){var t=e.time.split(","),o=t.map(function(e){var t=-1!==e.indexOf("#"),o=e.replace(/[^\d\-.]/g,"").split("-");return 1===o.length&&(o[1]=+o[0]+1),[e[0],+o[0],+o[1],t]});return e.time=o,e})})}(),function(){t=t.map(function(e){return e.filter(function(e){var s,t=e.time,o="MTWHF";for(s=0;s<t.length;s+=1)if(-1===o.indexOf(t[s][0]))return!1;return!0})})}(),function(){var e,o,s,n,a,i,r,c,l;for(o=0;o<t.length;o+=1){for(n=t[o],e={},s=0;s<n.length;s+=1)a=n[s],i=a.time.join(","),e.hasOwnProperty(i)?(r=e[i],"O"===a.status&&"O"!==r.status?e[i]=a:"F"===a.status&&"O"!==r.status&&"F"!==r.status?e[i]=a:(c=a.enrols.split(","),l=r.enrols.split(","),c[1]-c[0]<l[1]-l[0]&&(e[i]=a))):e[i]=a;t[o]=[];for(i in e)e.hasOwnProperty(i)&&t[o].push(e[i])}}(),function(){var e,o,s;for(e=0;e<t.length;e+=1)for(s=t[e],o=s.length-1;o>=0;o-=1)$("#fullclasses").is(":checked")?"O"!==s[o].status&&"F"!==s[o].status&&s.splice(o,1):"O"!==s[o].status&&s.splice(o,1)}(),t.sort(function(e,t){return e.length-t.length}),e(t)}function generate(e,t){"use strict";function n(n){var i,r,c,l,u,d,f,m,a=search(n,s,o);if(e){if(null===a)return pageError("Sorry about that!","We weren't able to create a timetable for you. Maybe try again with different courses, or including full classes."),void $("#timetable").removeClass("loading");for(f=1/0,m=-(1/0),i=0;i<classList.length;i+=1)classList[i].remove();for($(".class-shadow").remove(),clearLists(t),showEmpty(),l=[],i=0;i<a.length;i+=1)c=a[i],u=courseList.indexOf(c.course),createClass(c,u,l);for(i=0;i<n.length;i+=1)for(r=0;r<n[i].length;r+=1)u=courseList.indexOf(n[i][r].course),d=createShadow(n[i][r],u),f=Math.min(f,d.min),m=Math.max(m,d.max);t?restoreClasses():saveState(!0),hideEmpty(Math.floor(f),Math.floor(m)),shownDragNotice||(pageNotice("Did you know?","You can move classes around in the timetable below to suit you better!"),shownDragNotice=!0),$("#timetable").removeClass("loading")}}e!==!1&&(e=!0),t!==!0&&(t=!1),e===!0&&$("#timetable").addClass("loading"),clearWarning();var o=t?0:void 0,s=100*+document.getElementById("canclash").checked;fetchData(n)}var shownDragNotice=!1;
