function fetchData(e){"use strict";var i,t=[],s={},n={};for(i=0;i<courseList.length;i+=1)"CBS"!==courseList[i]&&timetableData.hasOwnProperty(courseList[i])&&(n[courseList[i]]=timetableData[courseList[i]].slice(1));for(function(){function u(e){return e.filter(function(t,s){return e.map(String).indexOf(String(t))===s})}var e,t,i,o,a,c,r,l;for(e in n)if(n.hasOwnProperty(e)&&(s[e]={},t=n[e],null!==t))for(r=0;r<t.length;r+=1){for(i=t[r],o=i[3],o=u(o),a=[],c=[],l=0;l<o.length;l+=1)a.push(o[l][0]),c.push(o[l][1]);a=a.join(","),0!==a.length&&(s[e].hasOwnProperty(i[0])||(s[e][i[0]]=[]),s[e][i[0]].push({time:a,status:i[1],enrols:i[2],course:e,component:i[0],location:c}))}}(),s.CBS={},$("#tbt").is(":checked")&&(s.CBS.TBT=[{time:"T 12",status:"O",enrols:"0,1",course:"CBS",component:"The Bible Talks",location:["Elec Eng 418"]},{time:"T 13",status:"O",enrols:"0,1",course:"CBS",component:"The Bible Talks",location:["Elec Eng 418"]},{time:"H 12",status:"O",enrols:"0,1",course:"CBS",component:"The Bible Talks",location:["Rup Myers Theatre"]},{time:"H 13",status:"O",enrols:"0,1",course:"CBS",component:"The Bible Talks",location:["Rup Myers Theatre"]}]),$("#cth").is(":checked")&&(s.CBS.CoreTheo=[{time:"T 17",status:"O",enrols:"0,1",course:"CBS",component:"Core Theology",location:["Colombo C"]},{time:"W 13",status:"O",enrols:"0,1",course:"CBS",component:"Core Theology",location:["CLB 4"]}]),$("#ctr").is(":checked")&&(s.CBS.CoreTrain=[{time:"T 16",status:"O",enrols:"0,1",course:"CBS",component:"Core Training",location:["Quad Sundial"]},{time:"T 18",status:"O",enrols:"0,1",course:"CBS",component:"Core Training",location:["Quad Sundial"]},{time:"W 12",status:"O",enrols:"0,1",course:"CBS",component:"Core Training",location:["Quad Sundial"]},{time:"W 14",status:"O",enrols:"0,1",course:"CBS",component:"Core Training",location:["Quad Sundial"]}]),$("#bib").is(":checked")&&(s.CBS.BibleStudy=[{time:"M 11",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"M 12",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"M 13",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"M 14",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"T 11",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"T 14",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"W 11",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"H 11",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"H 14",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]}]),i=0;i<customClasses.length;i+=1){var o={};for(var a in customClasses[i])customClasses[i].hasOwnProperty(a)&&(o[a]=customClasses[i][a]);s[o.course]={},s[o.course][o.component]=[o]}!function(){var e,n;for(e in s)if(s.hasOwnProperty(e))for(n in s[e])s[e].hasOwnProperty(n)&&t.push([s[e][n],s[e][n].length]);t.sort(function(e,t){return e[1]-t[1]}),t=t.map(function(e){return e[0]}),t=t.map(function(e){return e.map(function(e){var t=e.time.split(","),s=t.map(function(e){var t=-1!==e.indexOf("#"),s=e.replace(/[^\d\-.]/g,"").split("-");return 1===s.length&&(s[1]=+s[0]+1),[e[0],+s[0],+s[1],t]});return e.time=s,e})})}(),function(){t=t.map(function(e){return e.filter(function(e){var n,t=e.time,s="MTWHF";for(n=0;n<t.length;n+=1)if(-1===s.indexOf(t[n][0]))return!1;return!0})})}(),function(){var e,s,n,i,o,a,c,r,l;for(s=0;s<t.length;s+=1){for(i=t[s],e={},n=0;n<i.length;n+=1)o=i[n],a=o.time.join(","),e.hasOwnProperty(a)?(c=e[a],"O"===o.status&&"O"!==c.status?e[a]=o:"F"===o.status&&"O"!==c.status&&"F"!==c.status?e[a]=o:(r=o.enrols.split(","),l=c.enrols.split(","),r[1]-r[0]<l[1]-l[0]&&(e[a]=o))):e[a]=o;t[s]=[];for(a in e)e.hasOwnProperty(a)&&t[s].push(e[a])}}(),function(){var e,s,n;for(e=0;e<t.length;e+=1)for(n=t[e],s=n.length-1;s>=0;s-=1)$("#fullclasses").is(":checked")?"O"!==n[s].status&&"F"!==n[s].status&&n.splice(s,1):"O"!==n[s].status&&n.splice(s,1)}(),t.sort(function(e,t){return e.length-t.length}),e(t)}function generate(e,t){"use strict";function i(i){var a,c,r,l,u,d,f,h,o=search(i,n,s);if(e){if(null===o)return pageError("Sorry about that!","We weren't able to create a timetable for you. Maybe try again with different courses, or including full classes."),void $("#timetable").removeClass("loading");for(f=1/0,h=-(1/0),a=0;a<classList.length;a+=1)classList[a].remove();for($(".class-shadow").remove(),clearLists(t),showEmpty(),l=[],a=0;a<o.length;a+=1)r=o[a],u=courseList.indexOf(r.course),createClass(r,u,l);for(a=0;a<i.length;a+=1)for(c=0;c<i[a].length;c+=1)u=courseList.indexOf(i[a][c].course),d=createShadow(i[a][c],u),f=Math.min(f,d.min),h=Math.max(h,d.max);t?restoreClasses():saveState(!0),hideEmpty(Math.floor(f),Math.floor(h)),$("#timetable").removeClass("loading")}}e!==!1&&(e=!0),t!==!0&&(t=!1),e===!0&&$("#timetable").addClass("loading"),clearWarning();var s=t?0:void 0,n=100*+document.getElementById("canclash").checked;fetchData(i)}
