function fetchData(e){"use strict";var r="courses="+encodeURI(JSON.stringify(courseList)),n=[];$.getJSON("data.php",r,function(r){var t={};!function(){var e,n,i,l,o,f,a;for(e in r)if(r.hasOwnProperty(e)&&(t[e]={},n=r[e],null!==n))for(f=0;f<n.length;f+=1){for(i=n[f],l=i[3],o=[],a=0;a<l.length;a+=1)o.push(l[a][0]);o=o.join(","),t[e].hasOwnProperty(i[0])||(t[e][i[0]]=[]),0!==o.length&&t[e][i[0]].push([o,i[1],i[2],e,i[0]])}}(),t.CBS={},$("#tbt").is(":checked")&&(t.CBS.TBT=[["T 12","O","0,1","CBS","The Bible Talks"],["T 13","O","0,1","CBS","The Bible Talks"],["H 12","O","0,1","CBS","The Bible Talks"],["H 13","O","0,1","CBS","The Bible Talks"]]),$("#cth").is(":checked")&&(t.CBS.CoreTheo=[["T 17","O","0,1","CBS","Core Theology"],["W 13","O","0,1","CBS","Core Theology"]]),$("#ctr").is(":checked")&&(t.CBS.CoreTrain=[["T 16","O","0,1","CBS","Core Training"],["T 18","O","0,1","CBS","Core Training"],["W 12","O","0,1","CBS","Core Training"],["W 14","O","0,1","CBS","Core Training"]]),$("#bib").is(":checked")&&(t.CBS.BibleStudy=[["M 11","O","0,1","CBS","Bible Study"],["M 12","O","0,1","CBS","Bible Study"],["M 13","O","0,1","CBS","Bible Study"],["M 14","O","0,1","CBS","Bible Study"],["T 11","O","0,1","CBS","Bible Study"],["T 14","O","0,1","CBS","Bible Study"],["W 11","O","0,1","CBS","Bible Study"],["H 11","O","0,1","CBS","Bible Study"],["H 14","O","0,1","CBS","Bible Study"]]),function(){var e,r;for(e in t)if(t.hasOwnProperty(e))for(r in t[e])t[e].hasOwnProperty(r)&&n.push([t[e][r],t[e][r].length]);n.sort(function(e,r){return e[1]-r[1]}),n=n.map(function(e){return e[0]}),n=n.map(function(e){return e.map(function(e){var r=e[0].split(","),n=r.map(function(e){var r=e.replace(/[^\d\-.]/g,"").split("-");return 1===r.length&&(r[1]=+r[0]+1),[e[0],+r[0],+r[1]]});return e[0]=n,e})})}(),e(n)})}function generate(){"use strict";function e(e){var r={M:120,T:100,W:180,H:100,F:150},n={M:!1,T:!1,W:!1,H:!1,F:!1},t=-20,i=-20,l=-40,o=100,f=75,a=100,s=0;return function(){var l,t=e.map(function(e){return e[0][0]}),i=t.join("");for(l in r)r.hasOwnProperty(l)&&-1===i.indexOf(l)&&(s+=r[l],n[l]=!0);return s}(),function(){var r,n;for(n=0;n<e.length;n+=1)r=e[n][0],r[1]<10&&(s+=t),r[2]>=17&&(s+=i),r[2]>=20&&(s+=l);return s}(),function(){var r,t,i,l,u;for(r=0;r<e.length;r+=1)"The Bible Talks"===e[r][4]&&(t=e[r][0][0]),"Core Theology"===e[r][4]&&(i=e[r][0][0]),"Core Training"===e[r][4]&&(l=e[r][0][0]),"Bible Study"===e[r][4]&&(u=e[r][0][0]);t&&(s+=(1+!n[t])*o),i&&(s+=(1+!n[i])*f),l&&(s+=(1+!n[l])*f),u&&(s+=(1+!n[u])*a)}(),s}function r(e){var r,n,t;for(r=e.length-1;r>0;r-=1)n=Math.floor(Math.random()*(r+1)),t=e[r],e[r]=e[n],e[n]=t;return e}fetchData(function(n){function t(e,r){return e[0]!==r[0]?!1:e[1]>=r[2]||r[1]>=e[2]?!1:!0}function i(e,r,n){var i,l,o,f,a;for(i=0;i<n.length;i+=1)for(l=0;l<r.length;l+=1)for(f=e[l][r[l]],a=f[0],o=0;o<a.length;o+=1)if(t(n[i],a[o]))return!0;return!1}function l(e){for(var t,l,r=[],n=0;n<e.length;){for(t=e[n],l=r[n]+1||0;l<t.length&&i(e,r,t[l][0]);)l+=1;if(l===t.length){if(r[n]=0,r.pop(),n-=1,0>n)return null}else r[n]=l,n+=1}return r.map(function(r,n){return e[n][r]})}function o(t){t=void 0!==t?t:1e3;var i,o,a,u,s,f={score:-(1/0),timetable:[]};for(i=0;t>i;i+=1){for(s=n.slice(),o=0;o<s.length;o+=1)r(s[o]);if(a=l(s),null===a){0===i&&console.error("Could not generate timetable! Some clashes could not be resolved.");break}u=e(a),u>f.score&&(f.score=u,f.timetable=a)}return console.log("Generated timetable with score",f.score),f.timetable}var a,u,s,c,h,f=o();for(a=0;a<classList.length;a+=1)classList[a].remove();for($(".class-shadow").remove(),clearLists(),c=[],a=0;a<f.length;a+=1)s=f[a],h=courseList.indexOf(s[3]),createClass(s[0],s[3],s[4],h,c);for(c=[],a=0;a<n.length;a+=1)for(u=0;u<n[a].length;u+=1)h=courseList.indexOf(n[a][u][3]),createShadow(n[a][u][0],n[a][u][3]+n[a][u][4],h,c)})}
