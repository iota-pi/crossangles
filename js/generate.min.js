function fetchData(e){"use strict";var n,t=[],s={},r={};for(n=0;n<courseList.length;n+=1)"CBS"!==courseList[n]&&timetableData.hasOwnProperty(courseList[n])&&(r[courseList[n]]=timetableData[courseList[n]].slice(1));for(function(){function f(e){return e.filter(function(t,s){return e.map(String).indexOf(String(t))===s})}var e,t,n,i,a,o,l,c;for(e in r)if(r.hasOwnProperty(e)&&(s[e]={},t=r[e],null!==t))for(l=0;l<t.length;l+=1){for(n=t[l],i=n[4],i=f(i),a=[],o=[],c=0;c<i.length;c+=1)a.push(i[c][0]),o.push(i[c][1]);if(a=a.join(","),0!==a.length){s[e].hasOwnProperty(n[0])||(s[e][n[0]]=[]);var u=["O","F","C","S","T","c"][n[1]];s[e][n[0]].push({time:a,status:u,enrols:n[2]+","+n[3],course:e,component:n[0],location:o})}}}(),s.CBS={},$("#tbt").is(":checked")&&(s.CBS.TBT=JSON.parse(JSON.stringify(CBS.TBT))),$("#cth").is(":checked")&&(s.CBS.CoreTheo=JSON.parse(JSON.stringify(CBS.CoreTheo))),$("#ctr").is(":checked")&&(s.CBS.CoreTrain=JSON.parse(JSON.stringify(CBS.CoreTrain))),$("#bib").is(":checked")&&(s.CBS.BibleStudy=JSON.parse(JSON.stringify(CBS.BibleStudy))),n=0;n<customClasses.length;n+=1){var i={};for(var a in customClasses[n])customClasses[n].hasOwnProperty(a)&&(i[a]=customClasses[n][a]);s[i.course]={},s[i.course][i.component]=[i]}!function(){var e,r;for(e in s)if(s.hasOwnProperty(e))for(r in s[e])s[e].hasOwnProperty(r)&&t.push([s[e][r],s[e][r].length]);t.sort(function(e,t){return e[1]-t[1]}),t=t.map(function(e){return e[0]}),t=t.map(function(e){return e.map(function(e){var t=e.time.split(","),s=t.map(function(e){var t=-1!==e.indexOf("#"),s=e.replace(/[^\d\-.]/g,"").split("-");return 1===s.length&&(s[1]=+s[0]+1),[e[0],+s[0],+s[1],t]});return e.time=s,e})})}(),function(){t=t.map(function(e){return e.filter(function(e){var r,t=e.time,s="MTWHF";for(r=0;r<t.length;r+=1)if(-1===s.indexOf(t[r][0]))return!1;return!0})})}(),function(){var e,s,r,n,i,a,o,l,c;for(s=0;s<t.length;s+=1){for(n=t[s],e={},r=0;r<n.length;r+=1)i=n[r],a=i.time.join(","),e.hasOwnProperty(a)?(o=e[a],"O"===i.status&&"O"!==o.status?e[a]=i:"F"===i.status&&"O"!==o.status&&"F"!==o.status?e[a]=i:(l=i.enrols.split(","),c=o.enrols.split(","),l[1]-l[0]<c[1]-c[0]&&(e[a]=i))):e[a]=i;t[s]=[];for(a in e)e.hasOwnProperty(a)&&t[s].push(e[a])}}(),function(){var e,s,r;for(e=0;e<t.length;e+=1)for(r=t[e],s=r.length-1;s>=0;s-=1)$("#fullclasses").is(":checked")?"O"!==r[s].status&&"F"!==r[s].status&&r.splice(s,1):"O"!==r[s].status&&r.splice(s,1)}(),t.sort(function(e,t){return e.length-t.length}),e(t)}function generate(e,t){"use strict";function n(n){var a,o,l,c,f,u,h,d,i=search(n,r,s);if(e){if(null===i)return pageError("Sorry about that!","We weren't able to create a timetable for you. Maybe try again with different courses, or including full classes."),void $("#timetable").removeClass("loading");for(h=1/0,d=-(1/0),a=0;a<classList.length;a+=1)classList[a].remove();for($(".class-shadow").remove(),clearLists(t),showEmpty(),c=[],a=0;a<i.length;a+=1)l=i[a],f=courseList.indexOf(l.course),createClass(l,f,c);for(a=0;a<n.length;a+=1)for(o=0;o<n[a].length;o+=1)f=courseList.indexOf(n[a][o].course),u=createShadow(n[a][o],f),h=Math.min(h,u.min),d=Math.max(d,u.max);t?restoreClasses():saveState(!0),hideEmpty(Math.floor(h),Math.floor(d)),$("#timetable").removeClass("loading")}}e!==!1&&(e=!0),t!==!0&&(t=!1),e===!0&&$("#timetable").addClass("loading"),clearWarning();var s=t?0:void 0,r=100*+document.getElementById("canclash").checked;fetchData(n)}
