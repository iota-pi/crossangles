function fetchData(e){"use strict";var r="courses="+encodeURI(JSON.stringify(courseList)),i=[];$.getJSON("data.php",r,function(r){var n={};!function(){var e,i,t,f,o,l,a;for(e in r)if(r.hasOwnProperty(e)&&(n[e]={},i=r[e],null!==i))for(l=0;l<i.length;l+=1){for(t=i[l],f=t[3],o=[],a=0;a<f.length;a+=1)o.push(f[a][0]);o=o.join(","),n[e].hasOwnProperty(t[0])||(n[e][t[0]]=[]),0!==o.length&&n[e][t[0]].push([o,t[1],t[2],e,t[0]])}}(),n.CBS={},$("#tbt").is(":checked")&&(n.CBS.TBT=[["T 12","O","0,1","CBS","The Bible Talks"],["T 13","O","0,1","CBS","The Bible Talks"],["H 12","O","0,1","CBS","The Bible Talks"],["H 13","O","0,1","CBS","The Bible Talks"]]),$("#cth").is(":checked")&&(n.CBS.CoreTheo=[["T 17","O","0,1","CBS","Core Theology"],["W 13","O","0,1","CBS","Core Theology"]]),$("#ctr").is(":checked")&&(n.CBS.CoreTrain=[["T 16","O","0,1","CBS","Core Training"],["T 18","O","0,1","CBS","Core Training"],["W 12","O","0,1","CBS","Core Training"],["W 14","O","0,1","CBS","Core Training"]]),$("#bib").is(":checked")&&(n.CBS.BibleStudy=[["M 11","O","0,1","CBS","Bible Study"],["M 12","O","0,1","CBS","Bible Study"],["M 13","O","0,1","CBS","Bible Study"],["M 14","O","0,1","CBS","Bible Study"],["T 11","O","0,1","CBS","Bible Study"],["T 14","O","0,1","CBS","Bible Study"],["W 11","O","0,1","CBS","Bible Study"],["H 11","O","0,1","CBS","Bible Study"],["H 14","O","0,1","CBS","Bible Study"]]),function(){var e,r;for(e in n)if(n.hasOwnProperty(e))for(r in n[e])n[e].hasOwnProperty(r)&&i.push([n[e][r],n[e][r].length]);i.sort(function(e,r){return e[1]-r[1]}),i=i.map(function(e){return e[0]}),i=i.map(function(e){return e.map(function(e){var r=e[0].split(","),i=r.map(function(e){var r=e.replace(/[^\d\-.]/g,"").split("-");return 1===r.length&&(r[1]=+r[0]+1),[e[0],+r[0],+r[1]]});return e[0]=i,e})})}(),e(i)})}function generate(){"use strict";function e(e){var r={M:120,T:100,W:180,H:100,F:150},i={M:!1,T:!1,W:!1,H:!1,F:!1},n=-30,t=-30,f=-50,o=150,l=100,a=150,u=100,s=0;return function(){var f,n=e.map(function(e){return e[0][0]}),t=n.join("");for(f in r)r.hasOwnProperty(f)&&-1===t.indexOf(f)&&(s+=r[f],i[f]=!0);return s}(),function(){var r,i;for(i=0;i<e.length;i+=1)r=e[i][0],r[1]<10&&(s+=n),r[2]>17&&(s+=t),r[2]>19&&(s+=f);return s}(),function(){var r,n,t,f,u;for(r=0;r<e.length;r+=1)"The Bible Talks"===e[r][4]&&(n=e[r][0][0]),"Core Theology"===e[r][4]&&(t=e[r][0][0]),"Core Training"===e[r][4]&&(f=e[r][0][0]),"Bible Study"===e[r][4]&&(u=e[r][0][0]);n&&(s+=(1+!i[n])*o),t&&(s+=(1+!i[t])*l),f&&(s+=(1+!i[f])*l),u&&(s+=(1+!i[u])*a)}(),function(){var r,i,n,t;for(r=0;r<e.length;r+=1)if("CBS"===e[r][3])for(n=e[r][0],i=0;i<e.length;i+=1)if("CBS"!==e[i][3]&&(t=e[i][0],n[0]===t[1]&&(n[1]===t[2]||n[2]===t[1]))){s+=u;break}}(),s}fetchData(function(r){function i(e,r){return e[0]!==r[0]?!1:e[1]>=r[2]||r[1]>=e[2]?!1:!0}function n(e,r,n){var t,f,o,l,a;for(t=0;t<n.length;t+=1)for(f=0;f<r.length;f+=1)for(l=e[f][r[f]],a=l[0],o=0;o<a.length;o+=1)if(i(n[t],a[o]))return!0;return!1}function t(r,i){function B(){return a<t.length&&t.pop(),a-=1,0>a?(null===l.timetable&&(console.error("No timetable could be generated"),console.error("Try again with more clash hours")),!1):!0}function S(){return t.map(function(e,i){return r[i][e]})}for(var f,o,u,s,c,t=[],l={timetable:null,score:null},a=0;a<r.length;){for(u=r[a],s=t[a]||0;s<u.length&&(c=u[s][0],n(r,t,c));)s+=1;if(s<u.length)t[a]=s,a+=1,a===r.length&&(f=S(),o=e(f),o>l.score&&(l.timetable=f,l.score=o),B());else if(!B())break}return l.timetable}var o,l,a,u,s,f=t(r,0);for(o=0;o<classList.length;o+=1)classList[o].remove();for($(".class-shadow").remove(),clearLists(),u=[],o=0;o<f.length;o+=1)a=f[o],s=courseList.indexOf(a[3]),createClass(a[0],a[3],a[4],s,u);for(u={},o=0;o<r.length;o+=1)for(l=0;l<r[o].length;l+=1)s=courseList.indexOf(r[o][l][3]),createShadow(r[o][l][0],r[o][l][3]+r[o][l][4],s,u)})}
