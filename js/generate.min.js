function fetchData(e){"use strict";var s,t=[],i={},n={};for(s=0;s<courseList.length;s+=1)"CBS"!==courseList[s]&&timetableData.hasOwnProperty(courseList[s])&&(n[courseList[s]]=timetableData[courseList[s]].slice(1));for(function(){var e,t,s,o,r,a,u;for(e in n)if(n.hasOwnProperty(e)&&(i[e]={},t=n[e],null!==t))for(a=0;a<t.length;a+=1){for(s=t[a],o=[],r=[],u=4;u<s.length;u+=2)-1===o.indexOf(s[u])&&(o.push(times_index[s[u]]),r.push(locations_index[s[u+1]]));if(o=o.join(","),0!==o.length){i[e].hasOwnProperty(s[0])||(i[e][s[0]]=[]);var l=["O","F","C","S","T","c"][s[1]],c=components_index[s[0]];i[e][s[0]].push({time:o,status:l,enrols:s[2]+","+s[3],course:e,component:c,location:r})}}}(),i.CBS={},$("#tbt").is(":checked")&&(i.CBS.TBT=JSON.parse(JSON.stringify(CBS.TBT))),$("#cth").is(":checked")&&(i.CBS.CoreTheo=JSON.parse(JSON.stringify(CBS.CoreTheo))),$("#ctr").is(":checked")&&(i.CBS.CoreTrain=JSON.parse(JSON.stringify(CBS.CoreTrain))),$("#bib").is(":checked")&&(i.CBS.BibleStudy=JSON.parse(JSON.stringify(CBS.BibleStudy))),s=0;s<customClasses.length;s+=1){var o={};for(var r in customClasses[s])customClasses[s].hasOwnProperty(r)&&(o[r]=customClasses[s][r]);i[o.course]={},i[o.course][o.component]=[o]}!function(){var e,n;for(e in i)if(i.hasOwnProperty(e))for(n in i[e])i[e].hasOwnProperty(n)&&t.push([i[e][n],i[e][n].length]);t.sort(function(e,t){return e[1]-t[1]}),t=t.map(function(e){return e[0]}),t=t.map(function(e){return e.map(function(e){var t=e.time.split(","),i=t.map(function(e){var t=-1!==e.indexOf("#"),i=e.replace(/[^\d\-.]/g,"").split("-");return 1===i.length&&(i[1]=+i[0]+1),[e[0],+i[0],+i[1],t]});return e.time=i,e})})}(),function(){t=t.map(function(e){return e.filter(function(e){var n,t=e.time,i="MTWHF";for(n=0;n<t.length;n+=1)if(-1===i.indexOf(t[n][0]))return!1;return!0})})}(),function(){var e,i,n,s,o,r,a,u,l;for(i=0;i<t.length;i+=1){for(s=t[i],e={},n=0;n<s.length;n+=1)o=s[n],r=o.time.join(","),e.hasOwnProperty(r)?(a=e[r],"O"===o.status&&"O"!==a.status?e[r]=o:"F"===o.status&&"O"!==a.status&&"F"!==a.status?e[r]=o:(u=o.enrols.split(","),l=a.enrols.split(","),u[1]-u[0]<l[1]-l[0]&&(e[r]=o))):e[r]=o;t[i]=[];for(r in e)e.hasOwnProperty(r)&&t[i].push(e[r])}}(),t.sort(function(e,t){return e.length-t.length}),e(t)}function generate(e,t){"use strict";function o(o){var a,u,l,c,f,r=search(o,n,i,s);if(e){if(null===r)return pageError("Sorry about that!","We weren't able to create a timetable for you. Maybe try again with different courses, or including full classes."),void $("#timetable").removeClass("loading");for(a=0;a<classList.length;a+=1)classList[a].remove();for($(".class-shadow").remove(),clearLists(t),showEmpty(),c=[],a=0;a<r.length;a+=1)l=r[a],f=courseList.indexOf(l.course),createClass(l,f,c);var h,d=1/0,m=-(1/0);for(a=0;a<o.length;a+=1)for(u=0;u<o[a].length;u+=1)f=courseList.indexOf(o[a][u].course),h=createShadow(o[a][u],f),d=Math.min(d,h.min),m=Math.max(m,h.max);t?restoreClasses():saveState(),d!==1/0&&hideEmpty(Math.floor(d),Math.floor(m)),$("#timetable").removeClass("loading")}}e!==!1&&(e=!0),t!==!0&&(t=!1),e===!0&&$("#timetable").addClass("loading");var i=t?0:void 0,n=0,s=document.getElementById("fullclasses").checked;fetchData(o)}
