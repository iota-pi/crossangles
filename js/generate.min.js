function fetchData(e){"use strict";var t="courses="+encodeURI(JSON.stringify(courseList)),n=[];$.getJSON("data.php",t,function(t){var o={};!function(){function c(e){return e.filter(function(t,n){return e.map(String).indexOf(String(t))===n})}var e,n,s,r,i,u,a,l;for(e in t)if(t.hasOwnProperty(e)&&(o[e]={},n=t[e],null!==n))for(a=0;a<n.length;a+=1){for(s=n[a],r=s[3],r=c(r),i=[],u=[],l=0;l<r.length;l+=1)i.push(r[l][0]),u.push(r[l][1]);i=i.join(","),0!==i.length&&(o[e].hasOwnProperty(s[0])||(o[e][s[0]]=[]),o[e][s[0]].push({time:i,status:s[1],enrols:s[2],course:e,component:s[0],location:u}))}}(),o.CBS={},$("#tbt").is(":checked")&&(o.CBS.TBT=[{time:"T 12",status:"O",enrols:"0,1",course:"CBS",component:"The Bible Talks",location:["Elec Eng 418"]},{time:"T 13",status:"O",enrols:"0,1",course:"CBS",component:"The Bible Talks",location:["Elec Eng 418"]},{time:"H 12",status:"O",enrols:"0,1",course:"CBS",component:"The Bible Talks",location:["Rup Myers Theatre"]},{time:"H 13",status:"O",enrols:"0,1",course:"CBS",component:"The Bible Talks",location:["Rup Myers Theatre"]}]),$("#cth").is(":checked")&&(o.CBS.CoreTheo=[{time:"T 17",status:"O",enrols:"0,1",course:"CBS",component:"Core Theology",location:["Colombo C"]},{time:"W 13",status:"O",enrols:"0,1",course:"CBS",component:"Core Theology",location:["CLB 4"]}]),$("#ctr").is(":checked")&&(o.CBS.CoreTrain=[{time:"T 16",status:"O",enrols:"0,1",course:"CBS",component:"Core Training",location:["Quad Sundial"]},{time:"T 18",status:"O",enrols:"0,1",course:"CBS",component:"Core Training",location:["Quad Sundial"]},{time:"W 12",status:"O",enrols:"0,1",course:"CBS",component:"Core Training",location:["Quad Sundial"]},{time:"W 14",status:"O",enrols:"0,1",course:"CBS",component:"Core Training",location:["Quad Sundial"]}]),$("#bib").is(":checked")&&(o.CBS.BibleStudy=[{time:"M 11",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"M 12",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"M 13",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"M 14",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"T 11",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"T 14",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"W 11",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"H 11",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]},{time:"H 14",status:"O",enrols:"0,1",course:"CBS",component:"Bible Study",location:["Quad Sundial"]}]),function(){var e,t;for(e in o)if(o.hasOwnProperty(e))for(t in o[e])o[e].hasOwnProperty(t)&&n.push([o[e][t],o[e][t].length]);n.sort(function(e,t){return e[1]-t[1]}),n=n.map(function(e){return e[0]}),n=n.map(function(e){return e.map(function(e){var t=e.time.split(","),n=t.map(function(e){var t=-1!==e.indexOf("#"),n=e.replace(/[^\d\-.]/g,"").split("-");return 1===n.length&&(n[1]=+n[0]+1),[e[0],+n[0],+n[1],t]});return e.time=n,e})})}(),function(){n=n.map(function(e){return e.filter(function(e){var o,t=e.time,n="MTWHF";for(o=0;o<t.length;o+=1)if(-1===n.indexOf(t[o][0]))return!1;return!0})})}(),function(){var e,t,o,s,r,i,u,a,l;for(t=0;t<n.length;t+=1){for(s=n[t],e={},o=0;o<s.length;o+=1)r=s[o],i=r.time.join(","),e.hasOwnProperty(i)?(u=e[i],"O"===r.status&&"O"!==u.status?e[i]=r:"F"===r.status&&"O"!==u.status&&"F"!==u.status?e[i]=r:(a=r.enrols.split(","),l=u.enrols.split(","),a[1]-a[0]<l[1]-l[0]&&(e[i]=r))):e[i]=r;n[t]=[];for(i in e)e.hasOwnProperty(i)&&n[t].push(e[i])}}(),function(){var e,t,o;for(e=0;e<n.length;e+=1)for(o=n[e],t=o.length-1;t>=0;t-=1)$("#fullclasses").is(":checked")?"O"!==o[t].status&&"F"!==o[t].status&&o.splice(t,1):"O"!==o[t].status&&o.splice(t,1)}(),n.sort(function(e,t){return e.length-t.length}),e(n)})}function generate(e,t){"use strict";function s(s){var i,u,a,l,c,r=search(s,o,n);if(e&&null!==r){for(i=0;i<classList.length;i+=1)classList[i].remove();for($(".class-shadow").remove(),clearLists(t),l=[],i=0;i<r.length;i+=1)a=r[i],c=courseList.indexOf(a.course),createClass(a,c,l);for(l={},i=0;i<s.length;i+=1)for(u=0;u<s[i].length;u+=1)c=courseList.indexOf(s[i][u].course),createShadow(s[i][u],c,l);t?restoreClasses():saveState()}}e!==!1&&(e=!0),t!==!0&&(t=!1);var n=t?0:void 0,o=100*+document.getElementById("canclash").checked;fetchData(s)}
