function fetchData(e){"use strict";var s,t=[],a={},o={};for(s=0;s<courseList.length;s+=1)"CBS"!==courseList[s]&&timetableData.hasOwnProperty(courseList[s])&&(o[courseList[s]]=timetableData[courseList[s]].slice(1));for(function(){var e,t,s,n,i,c,r;for(e in o)if(o.hasOwnProperty(e)&&(a[e]={},t=o[e],null!==t))for(c=0;c<t.length;c+=1){for(s=t[c],n=[],i=[],r=4;r<s.length;r+=2)-1===n.indexOf(s[r])&&(n.push(times_index[s[r]]),i.push(locations_index[s[r+1]]));if(n=n.join(","),0!==n.length){a[e].hasOwnProperty(s[0])||(a[e][s[0]]=[]);var l=["O","F","C","S","T","c"][s[1]],d=components_index[s[0]];a[e][s[0]].push({time:n,status:l,enrols:s[2]+","+s[3],course:e,component:d,location:i})}}}(),a.CBS={},$("#tbt").is(":checked")&&(a.CBS.TBT=JSON.parse(JSON.stringify(CBS.TBT))),$("#cth").is(":checked")&&(a.CBS.CoreTheo=JSON.parse(JSON.stringify(CBS.CoreTheo))),$("#ctr").is(":checked")&&(a.CBS.CoreTrain=JSON.parse(JSON.stringify(CBS.CoreTrain))),$("#bib").is(":checked")&&(a.CBS.BibleStudy=JSON.parse(JSON.stringify(CBS.BibleStudy))),s=0;s<customClasses.length;s+=1){var n={};for(var i in customClasses[s])customClasses[s].hasOwnProperty(i)&&(n[i]=customClasses[s][i]);a[n.course]={},a[n.course][n.component]=[n]}!function(){var e,o;for(e in a)if(a.hasOwnProperty(e))for(o in a[e])a[e].hasOwnProperty(o)&&t.push([a[e][o],a[e][o].length]);t.sort(function(e,t){return e[1]-t[1]}),t=t.map(function(e){return e[0]}),t=t.map(function(e){return e.map(function(e){var t=e.time.split(","),a=t.map(function(e){var t=-1!==e.indexOf("#"),a=e.replace(/[^\d\-.]/g,"").split("-");return 1===a.length&&(a[1]=+a[0]+1),[e[0],+a[0],+a[1],t]});return e.time=a,e})})}(),function(){t=t.map(function(e){return e.filter(function(e){var o,t=e.time,a="MTWHF";for(o=0;o<t.length;o+=1)if(-1===a.indexOf(t[o][0]))return!1;return!0})})}(),function(){var e,a,o,s,n,i,c,r,l;for(a=0;a<t.length;a+=1){for(s=t[a],e={},o=0;o<s.length;o+=1)n=s[o],i=n.time.join(","),e.hasOwnProperty(i)?(c=e[i],"O"===n.status&&"O"!==c.status?e[i]=n:"F"===n.status&&"O"!==c.status&&"F"!==c.status?e[i]=n:(r=n.enrols.split(","),l=c.enrols.split(","),r[1]-r[0]<l[1]-l[0]&&(e[i]=n))):e[i]=n;t[a]=[];for(i in e)e.hasOwnProperty(i)&&t[a].push(e[i])}}(),function(){var e,a,o;for(e=0;e<t.length;e+=1)for(o=t[e],a=o.length-1;a>=0;a-=1)$("#fullclasses").is(":checked")?"O"!==o[a].status&&"F"!==o[a].status&&o.splice(a,1):"O"!==o[a].status&&o.splice(a,1)}(),t.sort(function(e,t){return e.length-t.length}),e(t)}function generate(e,t){"use strict";function s(s){var i,c,r,l,d,u,m,f,n=search(s,o,a);if(e){if(null===n)return pageError("Sorry about that!","We weren't able to create a timetable for you. Maybe try again with different courses, or including full classes."),void $("#timetable").removeClass("loading");for(m=1/0,f=-(1/0),i=0;i<classList.length;i+=1)classList[i].remove();for($(".class-shadow").remove(),clearLists(t),showEmpty(),l=[],i=0;i<n.length;i+=1)r=n[i],d=courseList.indexOf(r.course),createClass(r,d,l);for(i=0;i<s.length;i+=1)for(c=0;c<s[i].length;c+=1)d=courseList.indexOf(s[i][c].course),u=createShadow(s[i][c],d),m=Math.min(m,u.min),f=Math.max(f,u.max);t?restoreClasses():saveState(!0),hideEmpty(Math.floor(m),Math.floor(f)),$("#timetable").removeClass("loading")}}e!==!1&&(e=!0),t!==!0&&(t=!1),e===!0&&$("#timetable").addClass("loading"),clearWarning();var a=t?0:void 0,o=100*+document.getElementById("canclash").checked;fetchData(s)}
