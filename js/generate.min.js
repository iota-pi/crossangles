function fetchData(e){"use strict";var o,t=[],a={},n={};for(o=0;o<courseList.length;o+=1)"CBS"!==courseList[o]&&timetableData.hasOwnProperty(courseList[o])&&(n[courseList[o]]=timetableData[courseList[o]].slice(1));for(function(){var e,t,o,s,i,r,c;for(e in n)if(n.hasOwnProperty(e)&&(a[e]={},t=n[e],null!==t))for(r=0;r<t.length;r+=1){for(o=t[r],s=[],i=[],c=4;c<o.length;c+=2)-1===s.indexOf(o[c])&&(s.push(times_index[o[c]]),i.push(locations_index[o[c+1]]));if(s=s.join(","),0!==s.length){a[e].hasOwnProperty(o[0])||(a[e][o[0]]=[]);var l=["O","F","C","S","T","c"][o[1]],d=components_index[o[0]];a[e][o[0]].push({time:s,status:l,enrols:o[2]+","+o[3],course:e,component:d,location:i})}}}(),a.CBS={},$("#tbt").is(":checked")&&(a.CBS.TBT=JSON.parse(JSON.stringify(CBS.TBT))),$("#cth").is(":checked")&&(a.CBS.CoreTheo=JSON.parse(JSON.stringify(CBS.CoreTheo))),$("#ctr").is(":checked")&&(a.CBS.CoreTrain=JSON.parse(JSON.stringify(CBS.CoreTrain))),$("#bib").is(":checked")&&(a.CBS.BibleStudy=JSON.parse(JSON.stringify(CBS.BibleStudy))),o=0;o<customClasses.length;o+=1){var s={};for(var i in customClasses[o])customClasses[o].hasOwnProperty(i)&&(s[i]=customClasses[o][i]);a[s.course]={},a[s.course][s.component]=[s]}!function(){var e,n;for(e in a)if(a.hasOwnProperty(e))for(n in a[e])a[e].hasOwnProperty(n)&&t.push([a[e][n],a[e][n].length]);t.sort(function(e,t){return e[1]-t[1]}),t=t.map(function(e){return e[0]}),t=t.map(function(e){return e.map(function(e){var t=e.time.split(","),a=t.map(function(e){var t=-1!==e.indexOf("#"),a=e.replace(/[^\d\-.]/g,"").split("-");return 1===a.length&&(a[1]=+a[0]+1),[e[0],+a[0],+a[1],t]});return e.time=a,e})})}(),function(){t=t.map(function(e){return e.filter(function(e){var n,t=e.time,a="MTWHF";for(n=0;n<t.length;n+=1)if(-1===a.indexOf(t[n][0]))return!1;return!0})})}(),function(){var e,a,n,o,s,i,r,c,l;for(a=0;a<t.length;a+=1){for(o=t[a],e={},n=0;n<o.length;n+=1)s=o[n],i=s.time.join(","),e.hasOwnProperty(i)?(r=e[i],"O"===s.status&&"O"!==r.status?e[i]=s:"F"===s.status&&"O"!==r.status&&"F"!==r.status?e[i]=s:(c=s.enrols.split(","),l=r.enrols.split(","),c[1]-c[0]<l[1]-l[0]&&(e[i]=s))):e[i]=s;t[a]=[];for(i in e)e.hasOwnProperty(i)&&t[a].push(e[i])}}(),t.sort(function(e,t){return e.length-t.length}),e(t)}function generate(e,t){"use strict";function s(s){var r,c,l,d,u,i=search(s,n,a,o);if(e){if(null===i)return pageError("Sorry about that!","We weren't able to create a timetable for you. Maybe try again with different courses, or including full classes."),void $("#timetable").removeClass("loading");for(r=0;r<classList.length;r+=1)classList[r].remove();for($(".class-shadow").remove(),clearLists(t),showEmpty(),d=[],r=0;r<i.length;r+=1)l=i[r],u=courseList.indexOf(l.course),createClass(l,u,d);var h,m=1/0,f=-(1/0);for(r=0;r<s.length;r+=1)for(c=0;c<s[r].length;c+=1)u=courseList.indexOf(s[r][c].course),h=createShadow(s[r][c],u),m=Math.min(m,h.min),f=Math.max(f,h.max);t?restoreClasses():saveState(!0),hideEmpty(Math.floor(m),Math.floor(f)),$("#timetable").removeClass("loading")}}e!==!1&&(e=!0),t!==!0&&(t=!1),e===!0&&$("#timetable").addClass("loading");var a=t?0:void 0,n=0,o=document.getElementById("fullclasses").checked;fetchData(s)}
