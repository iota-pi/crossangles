function search(e,t){"use strict";function s(e,t){return e[0]!==t[0]?!1:Math.max(0,Math.min(e[2],t[2])-Math.max(e[1],t[1]))}function n(e,t,n){var o,r,i,u,c,l=0;for(o=0;o<n.length;o+=1)for(r=0;r<t.length;r+=1)for(u=e[r][t[r]],c=u.time,i=0;i<c.length;i+=1)l+=s(n[o],c[i]);return l}function o(e,s,o){for(var r=o[s]+1||0,i=e[s];r<i.length&&n(e,o,i[r].time)>t;)r+=1;return r===i.length?null:r}function r(e,t,s){var r,n=s||0,i=t||[];if(void 0!==s)for(;i.length>s;)i.pop();for(;n<e.length;)if(r=o(e,n,i),null===r){if(n<i.length&&i.pop(),n-=1,0>n)return null}else i[n]=r,n+=1;return i}function i(e){var t,s,n;for(t=e.length-1;t>0;t-=1)s=Math.floor(Math.random()*(t+1)),n=e[t],e[t]=e[s],e[s]=n;return e}function u(e,t){return t.score-e.score}function c(t){var n,o,c,s=[];for(o=0;t>o;o+=1){for(n={streams:[],timetable:null,score:null},c=0;c<e.length;c+=1)n.streams.push(i(e[c].slice()));if(n.timetable=r(n.streams),n.score=scoreTimetable(n.timetable,n.streams),null===n.timetable)return null;s.push(n)}return s.sort(u)}function l(e){var s,n,t={streams:[],timetable:null,score:null};for(s=0;s<e.streams.length;s+=1)t.streams.push(e.streams[s].slice());for(;null===t.timetable;)n=Math.floor(Math.random()*t.streams.length),i(t.streams[n]),t.timetable=r(t.streams,e.timetable.slice(),n);return t.score=scoreTimetable(t.timetable,t.streams),t}function a(e,t,s,n){if(null===e)return null;s=s||5e3,t=t||20,n=n||5;var o,r,i,c,a=(new Date).getTime(),f=500;for(o=0;s>o;o+=1)if(r=Math.floor(Math.random()*(e.length+n))%e.length,i=e[r],c=l(i),e.push(c),o%10===9){for(e.sort(u);e.length>t;)e.pop();if((new Date).getTime()-a>f){console.warn("search(): max execution time reached after "+o+" iterations");break}}return e[0]}void 0===t&&(t=0);var f=c(50),m=a(f);return null===m?(console.error("No timetables could be generated!"),null):m.timetable.map(function(e,t){return m.streams[t][e]})}
