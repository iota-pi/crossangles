function search(e,t){"use strict";function r(e,t){return e[0]!==t[0]?!1:Math.max(0,Math.min(e[2],t[2])-Math.max(e[1],t[1]))}function n(e,t,n){var l,a,i,s,u,o=0;for(l=0;l<n.length;l+=1)for(a=0;a<t.length;a+=1)for(s=e[a][t[a]],u=s[0],i=0;i<u.length;i+=1)o+=r(n[l],u[i]);return o}function l(e,r,l){for(var a=l[r]+1||0,i=e[r];a<i.length&&n(e,l,i[a][0])>t;)a+=1;return a===i.length?null:a}function a(e,t,r){var a,n=r||0,i=t||[];if(void 0!==r)for(;i.length>r;)i.pop();for(;n<e.length;)if(a=l(e,n,i),null===a){if(n<i.length&&i.pop(),n-=1,0>n)return null}else i[n]=a,n+=1;return i}function i(e){var t,r,n;for(t=e.length-1;t>0;t-=1)r=Math.floor(Math.random()*(t+1)),n=e[t],e[t]=e[r],e[r]=n;return e}function s(e,t){return t.score-e.score}function u(t){var n,l,u,r=[];for(l=0;t>l;l+=1){for(n={streams:[],timetable:null,score:null},u=0;u<e.length;u+=1)n.streams.push(i(e[u].slice()));if(n.timetable=a(n.streams),n.score=scoreTimetable(n.timetable,n.streams),null===n.timetable)return null;r.push(n)}return r.sort(s)}function o(e){var r,n,t={streams:[],timetable:null,score:null};for(r=0;r<e.streams.length;r+=1)t.streams.push(e.streams[r].slice());for(;null===t.timetable;)n=Math.floor(Math.random()*t.streams.length),i(t.streams[n]),t.timetable=a(t.streams,e.timetable.slice(),n);return t.score=scoreTimetable(t.timetable,t.streams),t}function f(e,t,r,n){if(null===e)return null;r=r||5e3,t=t||20,n=n||5;var l,a,i,u,f=(new Date).getTime(),m=500;for(l=0;r>l;l+=1)if(a=Math.floor(Math.random()*(e.length+n))%e.length,i=e[a],u=o(i),e.push(u),l%10===9){for(e.sort(s);e.length>t;)e.pop();if((new Date).getTime()-f>m){console.warn("search(): max execution time reached after "+l+" iterations");break}}return e[0]}void 0===t&&(t=0);var m=u(10),h=f(m);return null===h?(console.error("No timetables could be generated!"),null):h.timetable.map(function(e,t){return h.streams[t][e]})}
