function search(e,t,s){"use strict";function a(e,t){return e[0]!==t[0]?!1:e[3]||t[3]?!1:Math.max(0,Math.min(e[2],t[2])-Math.max(e[1],t[1]))}function o(e,t,s){var o,c,i,n,r,l=0;for(o=0;o<s.length;o+=1)for(c=0;c<t.length;c+=1)for(n=e[c][t[c]],r=n.time,i=0;i<r.length;i+=1)l+=a(s[o],r[i]);return l}function c(e,s,a){for(var c=a[s]+1||0,i=e[s];c<i.length&&o(e,a,i[c].time)>t;)c+=1;return c===i.length?null:c}function i(e,t,s){var o,a=s||0,i=t||[];if(void 0!==s)for(;i.length>s;)i.pop();for(;a<e.length;)if(o=c(e,a,i),null===o){if(a<i.length&&i.pop(),a-=1,0>a)return null}else i[a]=o,a+=1;return i}function n(e){var t,s,a;for(t=e.length-1;t>0;t-=1)s=Math.floor(Math.random()*(t+1)),a=e[t],e[t]=e[s],e[s]=a;return e}function r(e,t){return t.score-e.score}function l(t){var a,o,c,s=[];for(o=0;t>o;o+=1){for(a={streams:[],timetable:null,score:null},c=0;c<e.length;c+=1)a.streams.push(n(e[c].slice()));if(a.timetable=i(a.streams),a.score=scoreTimetable(a.timetable,a.streams),null===a.timetable)return null;s.push(a)}return s.sort(r)}function d(e){var s,a,t={streams:[],timetable:null,score:null};for(s=0;s<e.streams.length;s+=1)t.streams.push(e.streams[s].slice());for(;null===t.timetable;)a=Math.floor(Math.random()*t.streams.length),n(t.streams[a]),t.timetable=i(t.streams,e.timetable.slice(),a);return t.score=scoreTimetable(t.timetable,t.streams),t}function u(e,t,s,a){if(null===e)return null;if(0===s)return e[0];s=s||5e3,t=t||20,a=a||5;var o,c,i,n,l=(new Date).getTime(),u=500;for(o=0;s>o;o+=1)if(c=Math.floor(Math.random()*(e.length+a))%e.length,i=e[c],n=d(i),e.push(n),o%10===9){for(e.sort(r);e.length>t;)e.pop();if((new Date).getTime()-l>u){console.warn("search(): max execution time reached after "+o+" iterations");break}}return e.sort(r),e[0]}if(void 0===t&&(t=0),0===e.length)return[];var h=s>0?50:1,f=l(h),m=u(f,void 0,s);return null===m?null:m.timetable.map(function(e,t){return m.streams[t][e]})}
