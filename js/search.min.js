function search(e,t){"use strict";function s(e,t){return e[0]!==t[0]?!1:Math.max(0,Math.min(e[2],t[2])-Math.max(e[1],t[1]))}function i(e,t,i){var r,n,a,o,c,l=0;for(r=0;r<i.length;r+=1)for(n=0;n<t.length;n+=1)for(o=e[n][t[n]],c=o[0],a=0;a<c.length;a+=1)l+=s(i[r],c[a]);return l}function r(e,s,r){for(var n=r[s]+1||0,a=e[s];n<a.length&&i(e,r,a[n][0])>t;)n+=1;return n===a.length?null:n}function n(e,t,s){var n,i=s||0,a=t||[];if(void 0!==s)for(;a.length>s;)a.pop();for(;i<e.length;)if(n=r(e,i,a),null===n){if(i<a.length&&a.pop(),i-=1,0>i)return null}else a[i]=n,i+=1;return a}function a(e){var t,s,i;for(t=e.length-1;t>0;t-=1)s=Math.floor(Math.random()*(t+1)),i=e[t],e[t]=e[s],e[s]=i;return e}function o(e,t){return t.score-e.score}function c(t){var i,r,c,s=[];for(r=0;t>r;r+=1){for(i={streams:[],timetable:null,score:null},c=0;c<e.length;c+=1)i.streams.push(a(e[c].slice()));if(i.timetable=n(i.streams),i.score=scoreTimetable(i.timetable,i.streams),null===i.timetable)return null;s.push(i)}return s.sort(o)}function l(e){var s,i,t={streams:[],timetable:null,score:null};for(s=0;s<e.streams.length;s+=1)t.streams.push(e.streams[s].slice());for(;null===t.timetable;)i=Math.floor(Math.random()*t.streams.length),a(t.streams[i]),t.timetable=n(t.streams,e.timetable.slice(),i);return t.score=scoreTimetable(t.timetable,t.streams),t}function u(e,t,s,i){if(null===e)return null;s=s||5e3,t=t||20,i=i||5;var r,n,a,c,u=(new Date).getTime(),d=500;for(r=0;s>r;r+=1)if(n=Math.floor(Math.random()*(e.length+i))%e.length,a=e[n],c=l(a),e.push(c),r%10===9){for(e.sort(o);e.length>t;)e.pop();if((new Date).getTime()-u>d){console.warn("search(): max execution time reached after "+r+" iterations");break}}return e[0]}void 0===t&&(t=0);var d=c(10),h=u(d);return null===h?(console.error("No timetables could be generated!"),null):h.timetable.map(function(e,t){return h.streams[t][e]})}
