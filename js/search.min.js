function search(e,t){"use strict";function n(e,t){return e[0]!==t[0]?!1:Math.max(0,Math.min(e[2],t[2])-Math.max(e[1],t[1]))}function r(e,t,r){var s,o,i,l,u,a=0;for(s=0;s<r.length;s+=1)for(o=0;o<t.length;o+=1)for(l=e[o][t[o]],u=l.time,i=0;i<u.length;i+=1)a+=n(r[s],u[i]);return a}function s(e,n,s){for(var o=s[n]+1||0,i=e[n];o<i.length&&r(e,s,i[o].time)>t;)o+=1;return o===i.length?null:o}function o(e,t,n){var o,r=n||0,i=t||[];if(void 0!==n)for(;i.length>n;)i.pop();for(;r<e.length;)if(o=s(e,r,i),null===o){if(r<i.length&&i.pop(),r-=1,0>r)return null}else i[r]=o,r+=1;return i}function i(e){var t,n,r;for(t=e.length-1;t>0;t-=1)n=Math.floor(Math.random()*(t+1)),r=e[t],e[t]=e[n],e[n]=r;return e}function l(e,t){return t.score-e.score}function u(t){var r,s,u,n=[];for(s=0;t>s;s+=1){for(r={streams:[],timetable:null,score:null},u=0;u<e.length;u+=1)r.streams.push(i(e[u].slice()));if(r.timetable=o(r.streams),r.score=scoreTimetable(r.timetable,r.streams),null===r.timetable)return null;n.push(r)}return n.sort(l)}function a(e){var n,r,t={streams:[],timetable:null,score:null};for(n=0;n<e.streams.length;n+=1)t.streams.push(e.streams[n].slice());for(;null===t.timetable;)r=Math.floor(Math.random()*t.streams.length),i(t.streams[r]),t.timetable=o(t.streams,e.timetable.slice(),r);return t.score=scoreTimetable(t.timetable,t.streams),t}function c(e,t,n,r){if(null===e)return null;n=n||5e3,t=t||20,r=r||5;var s,o,i,u,c=(new Date).getTime(),f=500;for(s=0;n>s;s+=1)if(o=Math.floor(Math.random()*(e.length+r))%e.length,i=e[o],u=a(i),e.push(u),s%10===9){for(e.sort(l);e.length>t;)e.pop();if((new Date).getTime()-c>f){console.warn("search(): max execution time reached after "+s+" iterations");break}}return e[0]}void 0===t&&(t=0);var f=u(10),m=c(f);return null===m?(console.error("No timetables could be generated!"),null):m.timetable.map(function(e,t){return m.streams[t][e]})}
