function search(e,t,n){"use strict";function o(e,t){return e[0]!==t[0]?!1:e[3]||t[3]?!1:Math.max(0,Math.min(e[2],t[2])-Math.max(e[1],t[1]))}function r(e,t,n){var r,s,i,u,a,l=0;for(r=0;r<n.length;r+=1)for(s=0;s<t.length;s+=1)for(u=e[s][t[s]],a=u.time,i=0;i<a.length;i+=1)l+=o(n[r],a[i]);return l}function s(e,n,o){for(var s=o[n]+1||0,i=e[n];s<i.length&&r(e,o,i[s].time)>t;)s+=1;return s===i.length?null:s}function i(e,t,n){var r,o=n||0,i=t||[];if(void 0!==n)for(;i.length>n;)i.pop();for(;o<e.length;)if(r=s(e,o,i),null===r){if(o<i.length&&i.pop(),o-=1,0>o)return null}else i[o]=r,o+=1;return i}function u(e){var t,n,o;for(t=e.length-1;t>0;t-=1)n=Math.floor(Math.random()*(t+1)),o=e[t],e[t]=e[n],e[n]=o;return e}function a(e,t){return t.score-e.score}function l(t){var o,r,s,n=[];for(r=0;t>r;r+=1){for(o={streams:[],timetable:null,score:null},s=0;s<e.length;s+=1)o.streams.push(u(e[s].slice()));if(o.timetable=i(o.streams),o.score=scoreTimetable(o.timetable,o.streams),null===o.timetable)return null;n.push(o)}return n.sort(a)}function c(e){var n,o,t={streams:[],timetable:null,score:null};for(n=0;n<e.streams.length;n+=1)t.streams.push(e.streams[n].slice());for(;null===t.timetable;)o=Math.floor(Math.random()*t.streams.length),u(t.streams[o]),t.timetable=i(t.streams,e.timetable.slice(),o);return t.score=scoreTimetable(t.timetable,t.streams),t}function f(e,t,n,o){if(null===e)return null;n=n||5e3,t=t||20,o=o||5;var r,s,i,u,l=(new Date).getTime(),f=500;for(r=0;n>r;r+=1)if(s=Math.floor(Math.random()*(e.length+o))%e.length,i=e[s],u=c(i),e.push(u),r%10===9){for(e.sort(a);e.length>t;)e.pop();if((new Date).getTime()-l>f){console.warn("search(): max execution time reached after "+r+" iterations");break}}return e.sort(a),e[0]}if(void 0===t&&(t=0),0===e.length)return[];var m=l(50),h=f(m,void 0,n);return null===h?(console.error("No timetables could be generated!"),null):h.timetable.map(function(e,t){return h.streams[t][e]})}
