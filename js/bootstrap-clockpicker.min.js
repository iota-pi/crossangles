!function(){function p(t){return document.createElementNS(o,t)}function d(t){return(10>t?"0":"")+t}function m(t){var e=++f+"";return t?t+e:e}function C(e,o){function W(t,e){var c=a.offset(),r=/^touch/.test(t.type),h=c.left+k,p=c.top+k,d=(r?t.originalEvent.touches[0]:t).pageX-h,f=(r?t.originalEvent.touches[0]:t).pageY-p,m=Math.sqrt(d*d+f*f),g=!1;if(!e||!(v-b>m||m>v+b)){t.preventDefault();var y=setTimeout(function(){s.addClass("clockpicker-moving")},200);n&&a.append(S.canvas),S.setHand(d,f,!e,!0),i.off(l).on(l,function(t){t.preventDefault();var e=/^touch/.test(t.type),i=(e?t.originalEvent.touches[0]:t).pageX-h,s=(e?t.originalEvent.touches[0]:t).pageY-p;(g||i!==d||s!==f)&&(g=!0,S.setHand(i,s,!1,!0))}),i.off(u).on(u,function(t){i.off(u),t.preventDefault();var n=/^touch/.test(t.type),c=(n?t.originalEvent.changedTouches[0]:t).pageX-h,r=(n?t.originalEvent.changedTouches[0]:t).pageY-p;(e||g)&&c===d&&r===f&&S.setHand(c,r),"hours"===S.currentView?S.toggleView("minutes",w/2):o.autoclose&&(S.minutesView.addClass("clockpicker-dial-out"),setTimeout(function(){S.done()},w/2)),a.prepend(U),clearTimeout(y),s.removeClass("clockpicker-moving"),i.off(l)})}}var c=t(M),a=c.find(".clockpicker-plate"),h=c.find(".clockpicker-hours"),f=c.find(".clockpicker-minutes"),C=c.find(".clockpicker-am-pm-block"),T="INPUT"===e.prop("tagName"),H=T?e:e.find("input"),P=e.find(".input-group-addon"),S=this;if(this.id=m("cp"),this.element=e,this.options=o,this.isAppended=!1,this.isShown=!1,this.currentView="hours",this.isInput=T,this.input=H,this.addon=P,this.popover=c,this.plate=a,this.hoursView=h,this.minutesView=f,this.amPmBlock=C,this.spanHours=c.find(".clockpicker-span-hours"),this.spanMinutes=c.find(".clockpicker-span-minutes"),this.spanAmPm=c.find(".clockpicker-span-am-pm"),this.amOrPm=o.amOrPm||"PM",a.width(y),a.height(y),o.twelvehour,!1){var V=['<div class="clockpicker-am-pm-block">','<button type="button" class="btn btn-sm btn-default clockpicker-button clockpicker-am-button">',"AM</button>",'<button type="button" class="btn btn-sm btn-default clockpicker-button clockpicker-pm-button">',"PM</button>","</div>"].join("");t(V);t('<button type="button" class="btn btn-sm btn-default clockpicker-button am-button">AM</button>').on("click",function(){S.amOrPm="AM",t(".clockpicker-span-am-pm").empty().append(" AM"),S.update()}).appendTo(this.amPmBlock),t('<button type="button" class="btn btn-sm btn-default clockpicker-button pm-button">PM</button>').on("click",function(){S.amOrPm="PM",t(".clockpicker-span-am-pm").empty().append(" PM"),S.update()}).appendTo(this.amPmBlock)}o.autoclose||t('<button type="button" class="btn btn-sm btn-default btn-block clockpicker-button">'+o.donetext+"</button>").click(t.proxy(this.done,this)).appendTo(c),"top"!==o.placement&&"bottom"!==o.placement||"top"!==o.align&&"bottom"!==o.align||(o.align="left"),"left"!==o.placement&&"right"!==o.placement||"left"!==o.align&&"right"!==o.align||(o.align="top"),c.addClass(o.placement),c.addClass("clockpicker-align-"+o.align),this.spanHours.click(t.proxy(this.toggleView,this,"hours")),this.spanMinutes.click(t.proxy(this.toggleView,this,"minutes")),H.on("focus.clockpicker click.clockpicker",t.proxy(this.show,this)),P.on("click.clockpicker",t.proxy(this.toggle,this));var x,O,$,L,B=t('<div class="clockpicker-tick"></div>');if(o.twelvehour)for(x=1;24>=x;x+=1)O=B.clone(),$=x/12*Math.PI,L=v,O.css("font-size","120%"),O.css({left:k+Math.sin($)*L-b,top:k-Math.cos($)*L-b}),O.html(x%2===0?x/2:""),h.append(O),O.on(r,W);else for(x=0;24>x;x+=1){O=B.clone(),$=x/6*Math.PI;var D=x>0&&13>x;L=D?g:v,O.css({left:k+Math.sin($)*L-b,top:k-Math.cos($)*L-b}),D&&O.css("font-size","120%"),O.html(0===x?"00":x),h.append(O),O.on(r,W)}for(x=0;60>x;x+=5)O=B.clone(),$=x/30*Math.PI,O.css({left:k+Math.sin($)*v-b,top:k-Math.cos($)*v-b}),O.css("font-size","120%"),O.html(d(x)),f.append(O),O.on(r,W);if(a.on(r,function(e){0===t(e.target).closest(".clockpicker-tick").length&&W(e,!0)}),n){var U=c.find(".clockpicker-canvas"),N=p("svg");N.setAttribute("class","clockpicker-svg"),N.setAttribute("width",y),N.setAttribute("height",y);var z=p("g");z.setAttribute("transform","translate("+k+","+k+")");var j=p("circle");j.setAttribute("class","clockpicker-canvas-bearing"),j.setAttribute("cx",0),j.setAttribute("cy",0),j.setAttribute("r",2);var _=p("line");_.setAttribute("x1",0),_.setAttribute("y1",0);var F=p("circle");F.setAttribute("class","clockpicker-canvas-bg"),F.setAttribute("r",b);var q=p("circle");q.setAttribute("class","clockpicker-canvas-fg"),q.setAttribute("r",3.5),z.appendChild(_),z.appendChild(F),z.appendChild(q),z.appendChild(j),N.appendChild(z),U.append(N),this.hand=_,this.bg=F,this.fg=q,this.bearing=j,this.g=z,this.canvas=U}A(this.options.init)}function A(t){t&&"function"==typeof t&&t()}var s,t=window.jQuery,e=t(window),i=t(document),o="http://www.w3.org/2000/svg",n="SVGAngle"in window&&function(){var t,e=document.createElement("div");return e.innerHTML="<svg/>",t=(e.firstChild&&e.firstChild.namespaceURI)==o,e.innerHTML="",t}(),c=function(){var t=document.createElement("div").style;return"transition"in t||"WebkitTransition"in t||"MozTransition"in t||"msTransition"in t||"OTransition"in t}(),a="ontouchstart"in window,r="mousedown"+(a?" touchstart":""),l="mousemove.clockpicker"+(a?" touchmove.clockpicker":""),u="mouseup.clockpicker"+(a?" touchend.clockpicker":""),h=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null,f=0,k=120,v=100,g=74,b=13,y=2*k,w=c?350:1,M=['<div class="popover clockpicker-popover">','<div class="arrow"></div>','<div class="popover-title">','<span class="clockpicker-span-hours text-primary"></span>'," : ",'<span class="clockpicker-span-minutes"></span>','<span class="clockpicker-span-am-pm"></span>',"</div>",'<div class="popover-content">','<div class="clockpicker-plate">','<div class="clockpicker-canvas"></div>','<div class="clockpicker-dial clockpicker-hours"></div>','<div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"></div>',"</div>",'<span class="clockpicker-am-pm-block">',"</span>","</div>","</div>"].join("");C.DEFAULTS={"default":"",fromnow:0,placement:"bottom",align:"left",donetext:"Done",autoclose:!1,twelvehour:!1,vibrate:!0},C.prototype.toggle=function(){this[this.isShown?"hide":"show"]()},C.prototype.locate=function(){var t=this.element,e=this.popover,i=t.offset(),s=t.outerWidth(),o=t.outerHeight(),n=this.options.placement,c=this.options.align,a={};switch(e.show(),n){case"bottom":a.top=i.top+o;break;case"right":a.left=i.left+s;break;case"top":a.top=i.top-e.outerHeight();break;case"left":a.left=i.left-e.outerWidth()}switch(c){case"left":a.left=i.left;break;case"right":a.left=i.left+s-e.outerWidth();break;case"top":a.top=i.top;break;case"bottom":a.top=i.top+o-e.outerHeight()}e.css(a)},C.prototype.show=function(o){if(!this.isShown){A(this.options.beforeShow);var n=this;if(this.isAppended||(s=t(document.body).append(this.popover),e.on("resize.clockpicker"+this.id,function(){n.isShown&&n.locate()}),this.isAppended=!0),void 0===this.hours){var c=((this.input.prop("value")||this.options["default"]||"")+"").split(":");if("now"===c[0]){var a=new Date(+new Date+this.options.fromnow);c=[a.getHours(),a.getMinutes()]}this.hours=+c[0]||0,this.minutes=+c[1]||0,this.spanHours.html(d(this.hours)),this.spanMinutes.html(d(this.minutes)),this.spanAmPm.html(" "+this.amOrPm)}this.toggleView("hours"),this.locate(),this.isShown=!0,i.on("click.clockpicker."+this.id+" focusin.clockpicker."+this.id,function(e){var i=t(e.target);0===i.closest(n.popover).length&&0===i.closest(n.addon).length&&0===i.closest(n.input).length&&n.hide()}),i.on("keyup.clockpicker."+this.id,function(t){(27===t.keyCode||13===t.keyCode)&&n.hide()}),A(this.options.afterShow)}},C.prototype.hide=function(){A(this.options.beforeHide),this.isShown=!1,i.off("click.clockpicker."+this.id+" focusin.clockpicker."+this.id),i.off("keyup.clockpicker."+this.id),this.popover.hide(),A(this.options.afterHide)},C.prototype.toggleView=function(e,i){var s=!1;e="hours","minutes"===e&&"visible"===t(this.hoursView).css("visibility")&&(A(this.options.beforeHourSelect),s=!0);var o="hours"===e,n=o?this.hoursView:this.minutesView,c=o?this.minutesView:this.hoursView;this.currentView=e,this.spanHours.toggleClass("text-primary",o),this.spanMinutes.toggleClass("text-primary",!o),c.addClass("clockpicker-dial-out"),n.css("visibility","visible").removeClass("clockpicker-dial-out"),this.resetClock(i),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout(function(){c.css("visibility","hidden")},w),A(this.options.afterHourSelect)},C.prototype.resetClock=function(t){var e=this.currentView,i=this.hours+this.minutes/60,s="hours"===e,o=Math.PI/(s?6:30),c=i*o,a=s&&i>0&&13>i?g:v,r=Math.sin(c)*a,l=-Math.cos(c)*a,u=this;n&&t?(u.canvas.addClass("clockpicker-canvas-out"),setTimeout(function(){u.canvas.removeClass("clockpicker-canvas-out"),u.setHand(r,l)},t)):this.setHand(r,l)},C.prototype.setHand=function(e,i,s,o){var k,c=Math.atan2(e,-i),a="hours"===this.currentView,r=!0,l=Math.PI/(r&&a?12:a||s?6:30),u=Math.sqrt(e*e+i*i),p=this.options,f=a&&(v+g)/2>u,m=f?g:v;if(p.twelvehour&&(m=v),0>c&&(c=2*Math.PI+c),k=Math.round(c/l),c=k*l,r&&(k/=2),p.twelvehour?a?1>k&&(k+=12):(s&&(k*=5),60===k&&(k=0)):a?(12===k&&(k=0),k=f?0===k?12:k:0===k?0:k+12):(s&&(k*=5),60===k&&(k=0)),this[this.currentView]!==k&&h&&this.options.vibrate&&(this.vibrateTimer||(navigator[h](10),this.vibrateTimer=setTimeout(t.proxy(function(){this.vibrateTimer=null},this),100))),r?(this.hours=Math.floor(k),this.spanHours.html(this.hours),this.minutes=k%1>0?30:0,this.spanMinutes.html(d(this.minutes))):(this[this.currentView]=k,this[a?"spanHours":"spanMinutes"].html(d(k))),this.update(),!n)return void this[a?"hoursView":"minutesView"].find(".clockpicker-tick").each(function(){var e=t(this);e.toggleClass("active",k===+e.html())});o||!a&&k%5?(this.g.insertBefore(this.hand,this.bearing),this.g.insertBefore(this.bg,this.fg),this.bg.setAttribute("class","clockpicker-canvas-bg clockpicker-canvas-bg-trans")):(this.g.insertBefore(this.hand,this.bg),this.g.insertBefore(this.fg,this.bg),this.bg.setAttribute("class","clockpicker-canvas-bg"));var b=Math.sin(c)*m,y=-Math.cos(c)*m;this.hand.setAttribute("x2",b),this.hand.setAttribute("y2",y),this.bg.setAttribute("cx",b),this.bg.setAttribute("cy",y),this.fg.setAttribute("cx",b),this.fg.setAttribute("cy",y)},C.prototype.done=function(){A(this.options.beforeDone),this.hide(),this.update(),this.options.autoclose&&this.input.trigger("blur"),A(this.options.afterDone)},C.prototype.update=function(){A(this.options.beforeUpdate),this.options.breakHour&&(this.hours%12+this.minutes/60<this.options.breakHour&&"AM"===this.amOrPm?this.amOrPm="PM":this.hours%12+this.minutes/60>=this.options.breakHour&&"PM"===this.amOrPm&&(this.amOrPm="AM")),t(".clockpicker-span-am-pm").empty().append(" "+this.amOrPm);var e=this.input.prop("value"),i=d(this.hours)+":"+d(this.minutes);this.options.twelvehour&&(i=i+" "+this.amOrPm),this.input.prop("value",i),i!==e&&(this.input.triggerHandler("change"),this.isInput||this.element.trigger("change")),A(this.options.afterUpdate)},C.prototype.remove=function(){this.element.removeData("clockpicker"),this.input.off("focus.clockpicker click.clockpicker"),this.addon.off("click.clockpicker"),this.isShown&&this.hide(),this.isAppended&&(e.off("resize.clockpicker"+this.id),this.popover.remove())},t.fn.clockpicker=function(e){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var s=t(this),o=s.data("clockpicker");if(o)"function"==typeof o[e]&&o[e].apply(o,i);else{var n=t.extend({},C.DEFAULTS,s.data(),"object"==typeof e&&e);s.data("clockpicker",new C(s,n))}})}}();
