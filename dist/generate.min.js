function fetchData(e){"use strict";var n,t=[],i={},s={};for(n=0;n<courseList.length;n+=1)"CBS"!==courseList[n]&&timetableData.hasOwnProperty(courseList[n])&&(s[courseList[n]]=timetableData[courseList[n]].slice(1));for(function(){var e,t,n,o,a,r,c;for(e in s)if(s.hasOwnProperty(e)&&(i[e]={},t=s[e],null!==t))for(r=0;r<t.length;r+=1){for(n=t[r],o=[],a=[],c=4;c<n.length;c+=2)-1===o.indexOf(n[c])&&(o.push(times_index[n[c]]),a.push(locations_index[n[c+1]]));if(o=o.join(","),0!==o.length){i[e].hasOwnProperty(n[0])||(i[e][n[0]]=[]);var l=["O","F","C","S","T","c"][n[1]],u=components_index[n[0]];i[e][n[0]].push({time:o,status:l,enrols:n[2]+","+n[3],course:e,component:u,location:a})}}}(),i.CBS={},$("#tbt").is(":checked")&&(i.CBS.TBT=JSON.parse(JSON.stringify(CBS.TBT))),$("#cth").is(":checked")&&(i.CBS.CoreTheo=JSON.parse(JSON.stringify(CBS.CoreTheo))),$("#ctr").is(":checked")&&(i.CBS.CoreTrain=JSON.parse(JSON.stringify(CBS.CoreTrain))),$("#bib").is(":checked")&&(i.CBS.BibleStudy=JSON.parse(JSON.stringify(CBS.BibleStudy))),n=0;n<customClasses.length;n+=1){var o={};for(var a in customClasses[n])customClasses[n].hasOwnProperty(a)&&(o[a]=customClasses[n][a]);i[o.course]={},i[o.course][o.component]=[o]}!function(){var e,s;for(e in i)if(i.hasOwnProperty(e))for(s in i[e])i[e].hasOwnProperty(s)&&t.push([i[e][s],i[e][s].length]);t.sort(function(e,t){return e[1]-t[1]}),t=t.map(function(e){return e[0]}),t=t.map(function(e){return e.map(function(e){var t=e.time.split(","),i=t.map(function(e){var t=-1!==e.indexOf("#"),i=e.replace(/[^\d\-.]/g,"").split("-");return 1===i.length&&(i[1]=+i[0]+1),[e[0],+i[0],+i[1],t]});return e.time=i,e})})}(),function(){t=t.map(function(e){return e.filter(function(e){var s,t=e.time,i="MTWHF";for(s=0;s<t.length;s+=1)if(-1===i.indexOf(t[s][0]))return!1;return!0})})}(),function(){var e,i,s,n,o,a,r,c,l;for(i=0;i<t.length;i+=1){for(n=t[i],e={},s=0;s<n.length;s+=1)o=n[s],a=o.time.join(","),e.hasOwnProperty(a)?(r=e[a],"O"===o.status&&"O"!==r.status?e[a]=o:"F"===o.status&&"O"!==r.status&&"F"!==r.status?e[a]=o:(c=o.enrols.split(","),l=r.enrols.split(","),c[1]-c[0]<l[1]-l[0]&&(e[a]=o))):e[a]=o;t[i]=[];for(a in e)e.hasOwnProperty(a)&&t[i].push(e[a])}}(),t.sort(function(e,t){return e.length-t.length}),e(t)}function generate(e,t){"use strict";function o(o){var r,c,l,u,d,a=search(o,s,i,n);if(e){if(null===a)return pageError("Sorry about that!","We weren't able to create a timetable for you. Maybe try again with different courses, or including full classes."),void $("#timetable").removeClass("loading");for(r=0;r<classList.length;r+=1)classList[r].remove();for($(".class-shadow").remove(),clearLists(t),showEmpty(),u=[],r=0;r<a.length;r+=1)l=a[r],d=courseList.indexOf(l.course),createClass(l,d,u);var p,f=1/0,h=-(1/0);for(r=0;r<o.length;r+=1)for(c=0;c<o[r].length;c+=1)d=courseList.indexOf(o[r][c].course),p=createShadow(o[r][c],d),f=Math.min(f,p.min),h=Math.max(h,p.max);t?restoreClasses():saveState(),f!==1/0&&hideEmpty(Math.floor(f),Math.floor(h)),$("#timetable").removeClass("loading")}}e!==!1&&(e=!0),t!==!0&&(t=!1),e===!0&&$("#timetable").addClass("loading");var i=t?0:void 0,s=0,n=document.getElementById("fullclasses").checked;fetchData(o)}
